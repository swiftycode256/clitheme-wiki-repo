# 使用`clitheme-exec`命令行工具

使用`clitheme-exec`执行命令行指令以当前主题数据中的输出替换规则。你可以使用输出调试选项来获得编写替换规则所需的输出信息。

你可以使用`clitheme-exec`或`python3 -m clitheme.exec`：

```plaintext
$ clitheme-exec
使用方式：
        clitheme-exec (options) [command]
错误：未指定命令
使用"clitheme-exec --help"以获取使用方式
$ python3 -m clitheme.exec
<...>
```

## 执行命令

在命令前添加`clitheme-exec`：

```plaintext
$ clitheme-exec ls
<...>
$ clitheme-exec gcc test.c
<...>
```

### 使用sudo执行命令

如需使用`sudo`执行命令，请使用`sudo clitheme-exec`加上你想执行的命令，不要使用`clitheme-exec sudo`，因为会影响替换规则的命令限制条件。

```plaintext
$ sudo clitheme-exec <命令>
<...>
```

如果你已经应用了主题，但是依然收到“没有设定主题”的提示，那是因为使用`sudo`时没有保留你的用户文件夹信息。你可以在`/etc/sudoers`文件中添加`Defaults env_keep += "HOME"`或找到这一行并删除注释符号修复这个问题。

## 可以设定的选项

`clitheme-exec`目前支持以下输出调试选项：

- `--debug`：在每一行输出的前面加上标记
    - 标记符号为`o`时，表示该输出为standard output（`stdout`）
    - ~~标记符号为`e`时，表示该输出为standard error（`stderr`）~~
    - 标记符号的背景颜色：
        - **白色**：表示该行为本次读取的输出段落的开头
        - **蓝色**：表示该行输出执行替换规则后被改变
        - **红色**：表示执行替换规则时超时，并且输出没有被替换
    - `--debug-newlines`：永远用新的一行显示所有输出，如果没有以换行符号结束
- `--debug-color`：对每一行添加颜色标记：如果该行输出为stdout，则标记黄色。~~如果该行输出为stderr，则标记红色。~~
- `--showchars`：用明文显示部分终端控制字符
    - ASCII Escape（`{{ESC}}`）
    - Carriage换行（`\r`）
    - 换行符号（`\n`）
    - ASCII Backspace符号（`\x08`）
    - ASCII Bell符号（`\x07`）
- `--foreground-stat`：当进程的前台状态（通过`tcgetpgrp`获取）变动时，显示提示输出
    - `! Foreground: False (<PID>)`：进程退出前台状态
    - `! Foreground: True (<PID>)`：进程进入/重新进入前台状态
    - `<PID>`是当前前台进程的PID
- `--nosubst`：不进行任何输出替换，即使已设定主题

如需设定这些选项，请在**指定命令之前**指定这些选项，比如说：

```plaintext
$ clitheme-exec --debug --showchars gcc something.c
# 不要这样子写：
$ clitheme-exec gcc something.c --debug --showchars
```