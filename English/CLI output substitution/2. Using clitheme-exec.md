# Using `clitheme-exec`

Use `clitheme-exec` to run a command-line application while applying substitution rules in the current theme data. You can use debug options to get more information from the output used to write substitution rules.

You can use `clitheme-exec` or `python3 -m clitheme.exec`：

```plaintext
$ clitheme-exec
Usage:
	clitheme-exec (options) [command]
Error: no command specified
Run "clitheme-exec --help" for usage information
$ python3 -m clitheme.exec
<...>
```

## Running commands

Add `clitheme-exec` before the command you want to run:

```plaintext
$ clitheme-exec ls
<...>
$ clitheme-exec gcc test.c
<...>
```

### Using sudo to run commands

To run command with `sudo`, use `sudo clitheme-exec` with the command you want to run. Don't use `clitheme-exec sudo` as it will interfere with the command filters of substitution rules.

```plaintext
$ sudo clitheme-exec <command>
<...>
```

If you already have applied a theme, but still received a "no theme set" warning, this is because `sudo` didn't preserve your home directory information. You can add or uncomment the `Default env_keep += "HOME"` line in `/etc/sudoers` to fix this problem.

## Available options

`clitheme-exec` supports the following debug options:

- `--debug`：Add an indicator at the front of each line
    - When the indicator is `o`, it indicates output is standard output (`stdout`)
    - ~~When the indicator is `e`, it indcates output is standard error (`stderr`)~~
    - Indicator's background color:
        - **White**: Indicates this line is start of a read block of output
        - **Blue**: Indicates this line is modified by substitution rules
        - **Red**: Indicates that there is a timeout when applying substitution rules
    - `--debug-newlines`: Always add newlines for each line of output, if not terminated by a newline character
- `--debug-color`: Apply color to each line of output: labels yellow for standard output; ~~labels red for standard error~~
- `--showchars`: Display various control characters in plain text
    - ASCII Escape (`{{ESC}}`)
    - Carriage return (`\r`)
    - Return character (`\n`)
    - ASCII Backspace (`\x08`)
    - ASCII Bell (`\x07`)
- `--foreground-stat`: When the foreground process (obtained through `tcgetpgrp`) changes, show message output
    - `! Foreground: False (<PID>)`: Process exits foreground
    - `! Foreground: True (<PID>)`: Process enters foreground
    - `<PID>` is the process ID
- `--nosubst`: Don't perform any output substitutions even when a theme is set

These options must be specified before the command, such as:

```plaintext
$ clitheme-exec --debug --showchars gcc something.c
# Don't write it like this
$ clitheme-exec gcc something.c --debug --showchars
```
